---
format:
  html:
    code-fold: show
    toc: true
    code-overflow: wrap
---

![](images/regression%20model.png)

**This code:**

-   Implements the derived variables into two linear models for evaluation:

### Fitting Linear Model One:

where average crime rate change is the dependent variable, and average dispensary density change is the independent variable.

```{r, warning=FALSE}
source("~/gvsu/winter 23/CIS 635/NIMBY/cleaning/linear_model/variables/crime and dispenaries per capita.R")
colnames(linear_variables) 

model1 <- lm(linear_variables$crime_yoy_avg ~ linear_variables$dsp_yoy_avg,  
             data = linear_variables)


model1
summary(model1)


```


```{r}
library(tidyverse) # ggplot

ggplot(linear_variables, aes(x = dsp_yoy_avg, y = crime_yoy_avg)) +
  geom_point() + 
  # add linear regression line
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  # add axis labels and plot title
  xlab("Dispensary Density (Year-over-Year Change)") +
  ylab("Crime Rate (Year-over-Year Change)") +
  ggtitle("Relationship Between Dispensary Density and Crime Rate")
```





```{r}
#  y = YOY crime at the county level
model2 <- lm(linear_variables$crime_yoy_avg ~ linear_variables$dsp_yoy_avg +
               linear_variables$pct_poverty_rate  +
               linear_variables$pct_black  +
               linear_variables$pct_hispanic  +
               linear_variables$employeed_pop,
                data = linear_variables)

summary(model2)
model2


```
