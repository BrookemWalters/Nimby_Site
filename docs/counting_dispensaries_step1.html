<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>replicating nimby – counting_dispensaries_step1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/Main Title.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">replicating nimby</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./Final Report.html">
 <span class="menu-text">final report</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./counting_dispensaries_step1.html" aria-current="page">
 <span class="menu-text">database</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Label the Dispensaries with GeoCodes_step2.html">
 <span class="menu-text">classification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./calculate crime and dispensaries per capita_step3.html">
 <span class="menu-text">statistics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./build_the_linear_model_step4.html">
 <span class="menu-text">prediction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./references.html">
 <span class="menu-text">references</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nimbys-method" id="toc-nimbys-method" class="nav-link active" data-scroll-target="#nimbys-method">NIMBY’s Method:</a></li>
  <li><a href="#my-method" id="toc-my-method" class="nav-link" data-scroll-target="#my-method">My Method:</a>
  <ul class="collapse">
  <li><a href="#install-packages" id="toc-install-packages" class="nav-link" data-scroll-target="#install-packages">install packages:</a></li>
  <li><a href="#combine-files-into-a-single-dataframe-with-a-new-date-field" id="toc-combine-files-into-a-single-dataframe-with-a-new-date-field" class="nav-link" data-scroll-target="#combine-files-into-a-single-dataframe-with-a-new-date-field">combine files into a single dataframe, with a new date field:</a></li>
  <li><a href="#create-uniform-observation-fields" id="toc-create-uniform-observation-fields" class="nav-link" data-scroll-target="#create-uniform-observation-fields">create uniform observation fields:</a></li>
  <li><a href="#create-uniform-business-names" id="toc-create-uniform-business-names" class="nav-link" data-scroll-target="#create-uniform-business-names">create uniform business names</a></li>
  <li><a href="#identify-and-label-dispensaries-by-their-type" id="toc-identify-and-label-dispensaries-by-their-type" class="nav-link" data-scroll-target="#identify-and-label-dispensaries-by-their-type">identify and label dispensaries by their type</a></li>
  <li><a href="#find-missing-business-names" id="toc-find-missing-business-names" class="nav-link" data-scroll-target="#find-missing-business-names">find missing business names</a></li>
  <li><a href="#find-the-missing-zip-codes" id="toc-find-the-missing-zip-codes" class="nav-link" data-scroll-target="#find-the-missing-zip-codes">find the missing zip codes</a></li>
  <li><a href="#find-dispensaries-that-are-both-medical-and-recreational-sellers" id="toc-find-dispensaries-that-are-both-medical-and-recreational-sellers" class="nav-link" data-scroll-target="#find-dispensaries-that-are-both-medical-and-recreational-sellers">find dispensaries that are both medical and recreational sellers</a></li>
  <li><a href="#graph-the-results-for-analysis" id="toc-graph-the-results-for-analysis" class="nav-link" data-scroll-target="#graph-the-results-for-analysis">Graph the Results for Analysis:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<p><img src="images/counting dispensaries.png" class="img-fluid"></p>
<p><strong>This code: creates a dataframe of dispensaries from 2013 - 2023</strong></p>
<ul>
<li>retrieves all of the filenames from the working directory</li>
<li>retains the filename as new variable</li>
<li>combines the listed excel files from a defined directory into a single dataframe</li>
<li>creates a new date variable extracted from the filename</li>
<li>merges like variables with different column names together and overrides the N/As</li>
<li>cleans up the business names, and classifies the observation drawn from the license number prefix</li>
<li>finds missing business names and replaces the null values with features extracted from similar observations</li>
<li>finds the missing zips codes and replaces the null values with matching license numbers</li>
</ul>
<p>This section of my methodology was the most time intensive. Having quality historical data is the foundation of my project. Calculating the number of dispensaries is a key variable for the linear regression model.</p>
<section id="nimbys-method" class="level2">
<h2 class="anchored" data-anchor-id="nimbys-method">NIMBY’s Method:</h2>
<blockquote class="blockquote">
<p><em>The data on dispensary locations come from the Colorado Department of Revenue, which starting in January 2013 has published a monthly list of each active medical and recreational license. Overall, our sample covers 48 months between 2013 and 2016 for 143 census tracts in the City of Denver.</em></p>
<p><span class="citation" data-cites="brinkman2017">[@brinkman2017]</span></p>
</blockquote>
<p>NIMBY’s data were accessed at the no longer active <a href="www.colorado.gov/pacific/enforcement/ archived-med-medical-and-retail-marijuana-licensee-lists" title="Accessed by the authors in January 2017">Colorado.gov</a> page: in January 2017.<br>
</p>
</section>
<section id="my-method" class="level2">
<h2 class="anchored" data-anchor-id="my-method">My Method:</h2>
<p><em>Data Source:</em> Colorado Department of Revenue: <a href="https://sbg.colorado.gov/med/licensee-information" title="Dispensaries in the State of Colorado 2013 - 2023 by month, type, and location">Medical and Retail Marijuana Licencees</a><img src="images/CoDeptRev.png" class="img-fluid" width="165"><br>
Accessed April 2023</p>
<p>Before running the code below, I downloaded the dispensary files from the Colorado Department of Revenue’s monthly list of med licensee data archive, and manually adjusted the naming convention to reflect the file’s time period.</p>
<p><br>
</p>
<section id="install-packages" class="level3">
<h3 class="anchored" data-anchor-id="install-packages">install packages:</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0     ✔ purrr   1.0.1
✔ tibble  3.2.1     ✔ dplyr   1.1.1
✔ tidyr   1.2.1     ✔ stringr 1.5.0
✔ readr   2.1.3     ✔ forcats 0.5.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

Attaching package: 'lubridate'


The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
</section>
<section id="combine-files-into-a-single-dataframe-with-a-new-date-field" class="level3">
<h3 class="anchored" data-anchor-id="combine-files-into-a-single-dataframe-with-a-new-date-field">combine files into a single dataframe, with a new date field:</h3>
<p><span style="font-size: 80%;"><em>adapted from “<a href="https://community.rstudio.com/t/pass-chunk-of-filename-to-column-name-in-a-loop/141523" title="Posit Community">Pass chunk of filename to column name in a loop</a>”</em></span></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory for this chunk only</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/gvsu/winter 23/CIS 635/NIMBY/cleaning/dsp_data"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">dir_ls</span>() <span class="sc">%&gt;%</span> <span class="fu">set_names</span>() <span class="co"># grab all of the file names </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  the .id parameter creates a new column called "filename" </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>all_dsps <span class="ot">&lt;-</span> <span class="fu">map_df</span>(dsp, <span class="sc">~</span><span class="fu">read_excel</span>(.x), <span class="at">.id =</span> <span class="st">"filename"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
New names:
New names:
• `` -&gt; `...8`</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the date from the file name and create a new date column</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>all_dsps <span class="ot">&lt;-</span> all_dsps <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">str_extract</span>(filename, <span class="st">"</span><span class="sc">\\</span><span class="st">d{6}"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">"01"</span>, date), <span class="at">format =</span> <span class="st">"%d%m%Y"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
</section>
<section id="create-uniform-observation-fields" class="level3">
<h3 class="anchored" data-anchor-id="create-uniform-observation-fields">create uniform observation fields:</h3>
<p>The ledgers vary throughout the years. In order to create a cohesive database, I needed to ensure like fields held the same naming conventions so they can be aggregated together down the road.</p>
<table class="table">
<thead>
<tr class="header">
<th>dispensary record fields:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>city</strong></td>
<td><strong>dba</strong> (doing business as)</td>
</tr>
<tr class="even">
<td><strong>licensee</strong></td>
<td><strong>license number</strong></td>
</tr>
<tr class="odd">
<td><strong>zip code</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p><span style="font-size: 80%;"><em>adapted from “<a href="https://www.statology.org/dplyr-coalesce" title="Statology">How to Use the coalesce() Function in dplyr</a>”</em></span></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use coalesce to combine like columns and override the N/A</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="ot">&lt;-</span>  all_dsps <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dba =</span> <span class="fu">coalesce</span>(DBA,<span class="st">`</span><span class="at">DOING BUSINESS AS</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="fu">coalesce</span>(CITY, City)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">licensee =</span> <span class="fu">coalesce</span>(Licensee, Licensees, LICENSEE, <span class="st">`</span><span class="at">Licensee Name</span><span class="st">`</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">zip =</span> <span class="fu">coalesce</span>(ZIP, Zip, ZipCode)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">license_no =</span> <span class="fu">coalesce</span>(<span class="st">`</span><span class="at">Lic #</span><span class="st">`</span>,<span class="st">`</span><span class="at">LICENSE #</span><span class="st">`</span>, <span class="st">`</span><span class="at">License Number</span><span class="st">`</span>,LicenseNumber, license_no, <span class="st">`</span><span class="at">License #</span><span class="st">`</span> )) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a> <span class="co">#make a year column / variable</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(all_dsps<span class="sc">$</span>date, <span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(all_dsps, "firstbatch.csv")</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># select the relevant fields</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>all_dsps <span class="ot">&lt;-</span> all_dsps <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">26</span>, <span class="dv">37</span><span class="sc">:</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
</section>
<section id="create-uniform-business-names" class="level3">
<h3 class="anchored" data-anchor-id="create-uniform-business-names">create uniform business names</h3>
<p>Another inconsistent feature of the ledger includes many variations in the spelling of a business name. Throughout this project, I became vary familiar with the cannabis related business names and puns. I assume that if a similarly spelled business holds the same licence number, I can override that name to reflect the predominant naming convention. This tedious task was crucial in allowing me to match businesses that sell both medical and recreational products under different licenses.</p>
<div class="cell" data-hash="counting_dispensaries_step1_cache/html/unnamed-chunk-4_1e4825af58519d803a3ea584fb43bcaa">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same case</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">toupper</span>(all_dsps<span class="sc">$</span>dba) <span class="co"># DBA = "Doing Business As"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replace chaotic naming conventions</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3D CENTER"</span>,<span class="st">"3D CANNABIS CENTER"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3D CANNABIS CENTER AND 3D DISPENSARY"</span>,<span class="st">"3D CANNABIS CENTER"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3D DISPENSARY AND/OR 3D CANNABIS CENTER"</span>,<span class="st">"3D CANNABIS CENTER"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"21+"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" LLC"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># only remove LLC if nothing else follows</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LLC(?!.)$"</span>, <span class="st">""</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&amp;"</span>,<span class="st">"AND"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" INC"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"INC"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"'"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"?S"</span>,<span class="st">"S"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"-"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">":"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"COMPANY"</span>,<span class="st">""</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" CO(?!.)$"</span>, <span class="st">""</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"CO(?!.)$"</span>, <span class="st">""</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"CENTERS"</span>,<span class="st">"CENTER"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LLP(?!.)$"</span>, <span class="st">""</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"B.GOOD"</span>,<span class="st">"BGOOD"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"B.?GOOD"</span>,<span class="st">"BGOOD"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"B GOOD"</span>,<span class="st">"BGOOD"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"DEN REC"</span>,<span class="st">"DENREC"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"111"</span>,<span class="st">"1:11"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"111"</span>,<span class="st">"1:11"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ORGANICS"</span>,<span class="st">"ORGANIC"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ALPENGLOW BOTANICALS"</span>,<span class="st">"ALPENGLOW"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ALTITUDE ORGANIC CANNABIS"</span>,<span class="st">"ALTITUDE ORGANICS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ALTITUDE ORGANIC MEDICINE"</span>,<span class="st">"ALTITUDE ORGANICS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ANNIE?S DISPENSARY"</span>,<span class="st">"ANNIES DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ASCEND CANNABIS."</span>,<span class="st">"ASCEND CANNABIS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BACK TO THE GARDEN HEALTH AND WELLNESS CENTER"</span>,<span class="st">"BACK TO THE GARDEN"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BACK TO THE GARDENS"</span>,<span class="st">"BACK TO THE GARDEN"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BEAN WELLNESS GROUP II"</span>,<span class="st">"BEAN WELLNESS GROUP"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BEST LORADO CANNABIS"</span>,<span class="st">"BEST LORADO MEDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BEST LORADO MEDS ORG"</span>,<span class="st">"BEST LORADO MEDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BEST LORADO MEDS.ORG"</span>,<span class="st">"BEST LORADO MEDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BESTLORADOMEDS.ORG"</span>,<span class="st">"BEST LORADO MEDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BESTLORADOMEDS.ORG"</span>,<span class="st">"BEST LORADO MEDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BONFIRE CANNABIS MPANY"</span>,<span class="st">"BONFIRE CANNABIS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BOULDER MARIJUANA."</span>,<span class="st">"BOULDER MARIJUANA"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BOULDER WELLNESS CANNABIS"</span>,<span class="st">"BOULDER WELLNESS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BRECKENRIDGE ORGANIX"</span>,<span class="st">"BRECKENRIDGE ORGANIC THERAPHY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"BRECKENRIDGE CANNABIS CLUB"</span>,<span class="st">"BRECKENRIDGE ORGANIC THERAPHY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"CLEARANCE CANNABIS."</span>,<span class="st">"CLEARANCE CANNABIS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"CRESTED BUTTE WELLNESS CENTER"</span>,<span class="st">"CRESTED BUTTE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"CRESTED BUTTE ALTERNTIVE MEDICINE"</span>,<span class="st">"CRESTED BUTTE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"DO CRESTED BUTTE"</span>,<span class="st">"CRESTED BUTTE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"DOCTOR?S ORDERS"</span>,<span class="st">"DOCTORS ORDERS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ENLIGHTENED CARE PLUS"</span>,<span class="st">"ENLIGHTENED CARE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"FIFTY 2 EIGHTY"</span>,<span class="st">"FIFTY2EIGHTY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"GM ENTERPRISE."</span>,<span class="st">"GM ENTERPRISE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"GREEN DREAM CANNABIS"</span>,<span class="st">"GREEN DREAM"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"GREEN DREAM HEALTH SERVICES"</span>,<span class="st">"GREEN DREAM"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"GREEN GRASS CENTRAL CITY"</span>,<span class="st">"GREEN GRASS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"GREEN FIELDS"</span>,<span class="st">"GREENFIELDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HEADQUARTERS CANNABIS"</span>,<span class="st">"HEADQUARTERS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HEALING HOUSE DENVER"</span>,<span class="st">"HEALING HOUSE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HEALING HOUSE LAKEWOOD"</span>,<span class="st">"HEALING HOUSE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HELPING HANDS CANNABIS"</span>,<span class="st">"HELPINGHANDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HELPING HANDS HERBALS"</span>,<span class="st">"HELPINGHANDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HIGH COUNTRY HEALING 4"</span>,<span class="st">"HIGH COUNTRY HEALING"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HIGH COUNTRY HEALING 5"</span>,<span class="st">"HIGH COUNTRY HEALING"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HIGH COUNTRY HEALING 6"</span>,<span class="st">"HIGH COUNTRY HEALING"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"HIGH COUNTRY HEALING 8"</span>,<span class="st">"HIGH COUNTRY HEALING"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"IHC/SANTE"</span>,<span class="st">"IHC/SANTE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"IVITA WELLNESS"</span>,<span class="st">"IVITA"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"KIND LOVE / KL"</span>,<span class="st">"KIND LOVE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"KL"</span>,<span class="st">"KIND LOVE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"KIND LOVE EXPRESS"</span>,<span class="st">"KIND LOVE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"KIND MEDS"</span>,<span class="st">"KINDMEDS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LA NTES LNE BAR + DISPENSARY"</span>,<span class="st">"LANTES CLONE BAR AND DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LANTES CLONE BAR + DISPENSARY"</span>,<span class="st">"LANTES CLONE BAR AND DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LEAF ASPEN"</span>,<span class="st">"LEAF"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LEVELS IV."</span>,<span class="st">"LEVELS IV"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LIGHTSHADE LABS"</span>,<span class="st">"LIGHTSHADE"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LIVWELL III"</span>,<span class="st">"LIVWELL"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LORADO HARVEST SUPPLY"</span>,<span class="st">"LORADO HARVEST"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LORADO HARVEST COMPANY"</span>,<span class="st">"LORADO HARVEST"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"LOTUS MEDICAL II"</span>,<span class="st">"LOTUS MEDICAL"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MAGGIE?S FARM"</span>,<span class="st">"MAGGIES FARM"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MAGNOLIA ROAD CANNABIS COMPANY"</span>,<span class="st">"MAGNOLIA ROAD"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MAGNOLIA ROAD CANNABIS"</span>,<span class="st">"MAGNOLIA ROAD"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MAGNOLIA ROAD CANNABIS"</span>,<span class="st">"MAGNOLIA ROAD"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a> <span class="co"># removes all of the trailing names conventions</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MEDICINE MAN(?!.)$"</span>,<span class="st">"MEDICINE MAN"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span> )</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MMJ AMERICA(?!.$)"</span>,<span class="st">"MMJ AMERICA"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MOUNTAIN MEDICINALS(?!.)$"</span>,<span class="st">"MOUNTAIN MEDICINALS"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"COMPASSIONATE CARE(?!.)$"</span>,<span class="st">"COMPASSIONATE CARE"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MR. NICE GUYS"</span>,<span class="st">"MR NICE GUYS"</span>, all_dsps<span class="sc">$</span>dba) <span class="co">#</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NATIVE ROOTS(?!.)$"</span>,<span class="st">"NATIVE ROOTS"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NATURES HERBS(?!.)$"</span>,<span class="st">"NATURES HERBS"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NATURES MEDICINE(?!.)$"</span>,<span class="st">"NATURES MEDICINE"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NEW AMSTERDAM(?!.)$"</span>,<span class="st">"NEW AMSTERDAM"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"NORTHERN LIGHTS CANNABIS."</span>,<span class="st">"NORTHERN LIGHTS CANNABIS"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PATIENTS CHOICE(?!.)$"</span>,<span class="st">"PATIENTS CHOICE"</span>, all_dsps<span class="sc">$</span>dba,  <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PEAK"</span>,<span class="st">"PEAK DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PINK HOUSE(?!.)$"</span>,<span class="st">"PINK HOUSE"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PREFERRED ORGANIC(?!.)$"</span>,<span class="st">"PREFERRED ORGANIC"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PRIMO"</span>,<span class="st">"PRIMO CANNABIS"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PURE MARIJUANA DISPENSARY"</span>,<span class="st">"PURE DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba) <span class="co">#</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PURE MEDICAL DISPENSARY"</span>,<span class="st">"PURE DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"PURE MEDICAL"</span>,<span class="st">"PURE DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"RESERVE 1(?!.)$"</span>,<span class="st">"RESERVE 1"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) <span class="co">#</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"RIVERROCK(?!.)$"</span>,<span class="st">"RIVERROCK"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ROOTS RX"</span>,<span class="st">"ROOTSRX"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"SMOKEY?S"</span>,<span class="st">"SMOKEYS"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"SMOKED(?!.)$"</span>,<span class="st">"SMOKED"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"SMOKING GUN"</span>,<span class="st">"SMOKINGUN APOTHECARY"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"STAR BUDS"</span>,<span class="st">"STARBUDS"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"STEEL CITY MEDS(?!.)$"</span>,<span class="st">"STEEL CITY MEDS"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"STICKY BUDS(?!.)$"</span>,<span class="st">"STICKYBUDS"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"STICKY BUDS"</span>,<span class="st">"STICKYBUDS"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"TETRA HYDRO CENTER"</span>,<span class="st">"TETRAHYDROCENTER"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"THE CANARY?S SONG"</span>,<span class="st">"THE CANARYS SONG"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"THE CLINIC(?!.)$"</span>,<span class="st">"THE CLINIC"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"THE MEDICINE MAN"</span>,<span class="st">"MEDICINE MAN"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"THE SANCTUARY(?!.)$"</span>,<span class="st">"THE SANCTUARY"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"THE STONE"</span>,<span class="st">"THE STONE DISPENSARY"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"TRU CANNABIS(?!.)$"</span>,<span class="st">"TRU CANNABIS"</span>, all_dsps<span class="sc">$</span>dba, <span class="at">perl =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"TUMBLEWEEK DISPENSARY EDWARDS"</span>,<span class="st">"TUMBLEWEED DISPENSARY EDWARDS"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"UNITY RD. CANNABIS SHOP"</span>,<span class="st">"UNITY ROAD"</span>, all_dsps<span class="sc">$</span>dba) </span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"WALKING RAVEN II"</span>,<span class="st">"WALKING RAVEN"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"WOLF PAC CANNABIS"</span>,<span class="st">"WOLFPAC CANNABIS"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ALLGREENS"</span>,<span class="st">"CANNABIS MEDICAL TECHNOLOGY"</span>, all_dsps<span class="sc">$</span>dba)</span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>all_dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3D CANNABIS CENTER AND 3D DISPENSARY"</span>,<span class="st">"3D CANNABIS CENTER"</span>, all_dsps<span class="sc">$</span>dba)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This process takes a few minutes, so I exported the data for manual review.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(all_dsps,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"~/gvsu/winter 23/CIS 635/NIMBY/cleaning/counting_dispensaries/dps_data_cleaned/dispensaries.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
</section>
<section id="identify-and-label-dispensaries-by-their-type" class="level3">
<h3 class="anchored" data-anchor-id="identify-and-label-dispensaries-by-their-type">identify and label dispensaries by their type</h3>
<p>There are several type of licenses recorded by the Colorado Department of Revenue. NIMBY focuses on recreational and medical dispensaries, so those are the businesses I have identified based on the license number as shown below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cleaned_dsps <span class="ot">&lt;-</span> all_dsps</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>cleaned_dsps <span class="ot">&lt;-</span> cleaned_dsps <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">if_else</span>(<span class="fu">startsWith</span>(license_no, <span class="st">"402R"</span>), <span class="st">"retail"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">if_else</span>(<span class="fu">startsWith</span>(license_no, <span class="st">"402-"</span>), <span class="st">"medical"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"other"</span>)))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the testing facilities, growers and transporters</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>dsps <span class="ot">&lt;-</span>  cleaned_dsps <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"medical"</span> <span class="sc">|</span> type <span class="sc">==</span> <span class="st">"retail"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>dsps<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dsps<span class="sc">$</span>dba <span class="sc">==</span> <span class="st">"NONE"</span>, <span class="cn">NA</span>, dsps<span class="sc">$</span>dba) <span class="co"># change the None's to NAs</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>dsps<span class="sc">$</span>zip<span class="ot">&lt;-</span>  <span class="fu">substr</span>(dsps<span class="sc">$</span>zip, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">5</span>) <span class="co"># remove trailing numbers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
</section>
<section id="find-missing-business-names" class="level3">
<h3 class="anchored" data-anchor-id="find-missing-business-names">find missing business names</h3>
<p><span style="font-size: 80%;"><em>adapted from “<a href="https://stackoverflow.com/questions/52465215/dplyr-solution-using-slice-and-group" title="StackOverflow">Dplyr solution using slice and group</a>”</em></span></p>
<p>Along with variations in spelling, some years the “doing business as” field was left blank. Assuming the license number is only assigned to the same business identified in another time period, I can use that information to create a master list of business names to match against.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select all business names and license numbers</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dsps_list <span class="ot">&lt;-</span>dsps  <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dba, license_no) <span class="co">#</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the missing fields, coming for those later</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>dsps_list <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">na.omit</span>(dsps_list)) <span class="co"># remove na</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only the first instance (since their are multiple naming conventions </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for each licensee)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>dsps_list <span class="ot">&lt;-</span> dsps_list <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(license_no) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the business names by the license number </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># all.x = TRUE argument means include all rows from dsps </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a> <span class="co"># even if there is no matching row in dsps_list</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>dsps_merge <span class="ot">&lt;-</span> <span class="fu">merge</span>(dsps, dsps_list, <span class="at">by =</span> <span class="st">"license_no"</span>, <span class="at">all.x=</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#update the "doing business as" column, replace the N/As</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>dsps_merge<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">coalesce</span>(dsps_merge<span class="sc">$</span>dba.y, dsps_merge<span class="sc">$</span>dba.x)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># if that still doesn't work, update the umatched licence numbers with the licensee name</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>dsps_merge<span class="sc">$</span>dba <span class="ot">&lt;-</span> <span class="fu">coalesce</span>(dsps_merge<span class="sc">$</span>dba, dsps_merge<span class="sc">$</span>licensee)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the duplicated columns</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>dsps_merge <span class="ot">&lt;-</span>  dsps_merge <span class="sc">%&gt;%</span> </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    license_no,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    dba,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    city,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    zip,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    type,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    date,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is the new cleaned list of businesses with limited null fields!</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dsps_merge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  license_no                         dba   city   zip    type       date year
1  402-00001 CANNABIS MEDICAL TECHNOLOGY Denver 80204 medical 2020-08-01 2020
2  402-00001 CANNABIS MEDICAL TECHNOLOGY Denver 80204 medical 2016-02-01 2016
3  402-00001 CANNABIS MEDICAL TECHNOLOGY Denver 80204 medical 2020-12-01 2020
4  402-00001 CANNABIS MEDICAL TECHNOLOGY Denver 80204 medical 2015-04-01 2015
5  402-00001 CANNABIS MEDICAL TECHNOLOGY Denver 80204 medical 2013-11-01 2013
6  402-00001 CANNABIS MEDICAL TECHNOLOGY Denver 80204 medical 2016-05-01 2016</code></pre>
</div>
</div>
<p><br>
</p>
</section>
<section id="find-the-missing-zip-codes" class="level3">
<h3 class="anchored" data-anchor-id="find-the-missing-zip-codes">find the missing zip codes</h3>
<p>This same issue occurs with the zip code field, I apply the same technique used to find missing businesses.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dsps_zips <span class="ot">&lt;-</span>dsps_merge  <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(zip, city, license_no) <span class="co"># add type for a distinct list</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dsps_zips <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">na.omit</span>(dsps_zips)) <span class="co"># remove na</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only the main/  first instance</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>dsps_zips<span class="ot">&lt;-</span> dsps_zips <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(license_no) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#save this for creating per capita variables</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dsps_zips,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">"~/gvsu/winter 23/CIS 635/NIMBY/cleaning/counting_dispensaries/dps_data_cleaned/dsps_zips.csv"</span>)  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># xlook-up R style: overide the na's with the matches, same as a left_join</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>dsps_merge_zips <span class="ot">&lt;-</span> <span class="fu">merge</span>(dsps_merge, dsps_zips, <span class="at">by =</span> <span class="st">"license_no"</span>, <span class="at">all.x=</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>dsps_merge_zips<span class="sc">$</span>zip <span class="ot">&lt;-</span> <span class="fu">coalesce</span>(dsps_merge_zips<span class="sc">$</span>zip.x, dsps_merge_zips<span class="sc">$</span>zip.y)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the duplicated columns, and update the main data frame</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>storelist<span class="ot">&lt;-</span>  dsps_merge_zips <span class="sc">%&gt;%</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    license_no,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    dba,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    type,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> city.x,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    zip,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    date,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    year</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># export for manual review if needed</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(storelist,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>          <span class="st">"~/gvsu/winter 23/CIS 635/NIMBY/cleaning/counting_dispensaries/dps_data_cleaned/dispensaries.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
</section>
<section id="find-dispensaries-that-are-both-medical-and-recreational-sellers" class="level3">
<h3 class="anchored" data-anchor-id="find-dispensaries-that-are-both-medical-and-recreational-sellers">find dispensaries that are both medical and recreational sellers</h3>
<p><span style="font-size: 80%;"><em>adapted from “<a href="https://www.youtube.com/watch?v=Yg-pNqzDuN4" title="Statistics Globe Youtube Channel">Join Data with dplyr in R: 6 Examples</a>”</em></span></p>
<p>This is where my methodology differs drastically from the original paper. NIMBY matches the physical locations to determine which licensees are both medical and recreational (or retail).</p>
<blockquote class="blockquote">
<p><em>Our algorithm utilizes a customized cross-walk that identifies licenses assigned to the same address (e.g.&nbsp;matches 250 W. Colfax to 250 West Colfax) and identifies the co-location of medical and recreational based on the name of the business holding the licenses (since recreational licensees were granted only to the license holders of medical license).</em></p>
<p><span class="citation" data-cites="brinkman2017">[@brinkman2017]</span></p>
</blockquote>
<p><img src="images/classifying.png" class="img-fluid" width="245"></p>
<p>My approach to creating three buckets of dispensaries:</p>
<ul>
<li><p>divide the data into two sets; “medical” and “retail” ,</p></li>
<li><p>cross compare the lists, and identify where a business name appears in the “both” categories during the same time period</p></li>
<li><p>remove the collocations from the retail and medical businesses</p></li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide this into two new dataframes, one for medical, one for recreational</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>med_dsp <span class="ot">&lt;-</span> <span class="fu">filter</span>(storelist, type <span class="sc">==</span> <span class="st">"medical"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rec_dsp <span class="ot">&lt;-</span> <span class="fu">filter</span>(storelist, type <span class="sc">==</span> <span class="st">"retail"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># find the business that have the same name, city and date</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># with two different names, so this is my best estimate</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>both_dsp <span class="ot">&lt;-</span> <span class="fu">merge</span>(med_dsp, rec_dsp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dba"</span>, <span class="st">"date"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    dba,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"city"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">city.x</span><span class="st">`</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    date,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">year.x</span><span class="st">`</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"zip"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">zip.x</span><span class="st">`</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>both_dsp<span class="sc">$</span>type <span class="ot">&lt;-</span>  <span class="st">"both"</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>both_dsp <span class="ot">&lt;-</span> both_dsp <span class="sc">%&gt;%</span>  <span class="fu">distinct</span>(dba, date, type, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># removes the "both" businesses from the respective dataframes</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>med_only <span class="ot">&lt;-</span> med_dsp <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(both_dsp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dba"</span>, <span class="st">"date"</span>))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>med_only<span class="sc">$</span>type <span class="ot">&lt;-</span>  <span class="st">"med_only"</span> <span class="co"># label the type</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>rec_only <span class="ot">&lt;-</span> rec_dsp <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(both_dsp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dba"</span>, <span class="st">"date"</span>))</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>rec_only<span class="sc">$</span>type <span class="ot">&lt;-</span>  <span class="st">"rec_only"</span> <span class="co"># label the type</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the dataframes together (like if i were to copy and paste it at the bottom of an excel file)</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>storelist_cleaned <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(med_only,both_dsp, rec_only )</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>storelist_cleaned <span class="ot">&lt;-</span> storelist_cleaned <span class="sc">%&gt;%</span>  <span class="fu">distinct</span>(dba, type, date, zip, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(storelist_cleaned,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>          <span class="st">"dispensary_types_defined.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="graph-the-results-for-analysis" class="level3">
<h3 class="anchored" data-anchor-id="graph-the-results-for-analysis">Graph the Results for Analysis:</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the results</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dsps_growth$date &lt;-  ymd(dsps$date)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dsps_growth$type &lt;- factor(dsps_growth$type,</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                             levels=c("med_only", "both", "rec_only"))</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dsps_growth$type &lt;- factor(dsps_growth$type, levels = rev(c("med_only", "both", "rec_only")))</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>dsps_growth <span class="ot">&lt;-</span> storelist_cleaned <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">&lt;</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>         dba,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>         date) <span class="sc">%&gt;%</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date, type) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_licenses =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a graph</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fig1.b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsps_growth, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> num_licenses, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fill =</span> <span class="fu">factor</span>(type))) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_area</span>(<span class="at">alpha=</span><span class="fl">0.6</span> , <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">colour=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">scale_fill_manual</span>(<span class="at">values =</span><span class="fu">c</span>(<span class="st">"#B41876"</span>,<span class="st">"#23CB7F"</span>, <span class="st">"#1679A6"</span>)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                               </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">800</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.Date</span>(<span class="st">"2014-01-01"</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2014-09-01"</span>) <span class="sc">+</span> <span class="dv">30</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="dv">750</span>, <span class="at">label =</span> <span class="st">"first recreational sales"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">"Times New Roman"</span>) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2015-01-01"</span>), <span class="at">y =</span> <span class="dv">500</span>, <span class="at">label =</span> <span class="st">"both"</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2015-01-01"</span>), <span class="at">y =</span> <span class="dv">300</span>, <span class="at">label =</span> <span class="st">"medical only"</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2015-01-01"</span>), <span class="at">y =</span> <span class="dv">50</span>, <span class="at">label =</span> <span class="st">"rec only"</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Number of Stores"</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span><span class="st">"Year"</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Type"</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Dispensary Growth"</span>,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"State of Colorado 2013–2016"</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig1.b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<p><img src="counting_dispensaries_step1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/dsp_growth.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>